from nuviAPI import s3_api
import os

dep_date = {
"gwangmyeong-gurumsan-dc": "2024-12-13",
"bitgaon-dc": "2024-12-13",
"daeyeon-dc": "2024-12-04",
"taehwa-dc": "2024-12-24",
"andong-hana-dc": "2024-12-24",
"gochang-es-k": "2024-12-11",
"haannuri-dc": "2024-12-13",
"dohwa-danuri-dc": "2024-12-04",
"oryukdo-dc": "2024-12-11",
"pungsan-dc": "2024-12-24",
"hwabuk-dc": "2024-12-24",
"saessak-dc": "2024-12-24",
"daesanpurunsoop-dc": "2024-12-04",
"prugiohaengboksoop-dc": "2024-12-27",
"prugiohaengboksoop-dc": "2024-12-30",
"prugioai-dc": "2024-12-04",
"prugioai-dc": "2024-12-23",
"segkyo-piaje-dc": "2024-12-11",
"kidsi1-dc": "2024-12-12",
"sentber-dc": "2024-12-13",
"haengboksoop-dc": "2024-12-31",
"onemajor-xi-dc": "2024-12-31",
"ungnam-dc": "2024-12-04",
"jincheon-kkumnarae-dc": "2024-12-04",
"maesuri9danji-dc": "2024-12-04",
"ireader-dc": "2024-12-27",
"songi-dc": "2024-12-24",
"bansong-dc": "2024-12-04",
"hobanhassalgadeuk-dc": "2024-12-27",
"sirip-sujain-dc": "2024-12-04",
"gamman-dc": "2024-12-11",
"edufore-dc": "2024-12-04",
"eundo-dc": "2024-12-04",
"hyeopsungelisian-dc": "2024-12-31",
"sirip-gochoncentralzai-dc": "2024-12-04",
"haecheoreom-dc": "2024-12-30",
"kimpo-dc": "2024-12-04",
"jaeseong-dc": "2024-12-04",
"gongdan-busan-dc": "2024-12-30",
"sireip-thefirst-dc": "2024-12-04",
"andonguniv-dc": "2024-12-24",
"yeneung-easternkids-dc": "2024-12-13",
"gbdooffice-dc": "2024-12-18",
"gongdan-siheung-dc": "2024-12-04",
"yewa-eun-dc": "2024-12-24",
"gongdan-namdong-dc": "2024-12-23",
"kidspark-dc": "2024-12-27",
"jangyu-dc": "2024-12-27",
"daejeon-geomchal-dc": "2024-12-26",
"gamsawon-dc": "2024-12-04",
"magok6-forest-dc": "2024-12-04",
"gwandong-dc": "2024-12-31",
"guribgayang-dc": "2024-12-04",
"yangwoo-dasom-dc": "2024-12-30",
"ijoa-dc": "2024-12-11",
"daewon-dc": "2024-12-04",
"gongdan-deungchon-dc": "2024-12-04",
"icheonsadongcho-k": "2024-12-11",
"gongdan-gomdallae-dc": "2024-12-04",
"elium-dc": "2024-12-04",
"yongdang-dc": "2024-12-04",
"yebit-dc": "2024-12-13",
"chamsarang-dc": "2024-12-27",
"kyungsung-dc": "2024-12-11",
"algok-dc": "2024-12-13",
"yongho-dc": "2024-12-11",
"daekyo-newif-daycare-dc": "2024-12-12",
"sarang-rehab-daycare-dc": "2024-12-12",
"umjichangui-dc": "2024-12-13",
"yerim-dc": "2024-12-13",
"kwangdo-dc": "2024-12-27",
"gaeum-dc": "2024-12-17",
"yangjae2dong-dc": "2024-12-18",
"dowon-dc": "2024-12-24",
"bukbu-dc": "2025-01-08",
"seoul-cityhall-dc": "2025-01-03",
"gongdan-gwangju-dc": "2025-01-08",
"dongbaek-dc": "2025-01-15",
"haengboksoop-dc": "2025-01-08",
"arang-k": "2025-01-17",
"han-areum-dc": "2025-01-15",
"bonghwa-dc": "2025-01-08",
"kidsi1-dc": "2025-01-09",
"eobang-dc": "2025-01-08",
"baekhap-dc": "2025-01-09",
"onemajor-xi-dc": "2025-01-08",
"goongdan-imsilgun-dc": "2025-01-22",
"ja-yeon-yua-dc": "2025-01-23",
"parannara-dc": "2025-01-03",
"gongdan-gyelyong-dc": "2025-01-09",
"cheongwongu-office-dc": "2025-01-08",
"hyeopsungelisian-dc": "2025-01-08",
"gongdan-busan-dc": "2025-01-16",
"busanjin-gu-office-dc": "2025-01-15",
"daecheong-dc": "2025-01-08",
"haecheoreom-dc": "2025-01-16",
"gwandong-dc": "2025-01-08",
"rishubill-dc": "2025-01-08",
"centumjenis-dc": "2025-01-08",
"onemajorhillstate-dc": "2025-01-10",
"yuna-dc": "2025-01-15",
"yonggang-dc": "2025-01-09",
"kyungsung-dc": "2025-01-24",
"saessaknara-k": "2025-01-08",
"jangyu-dc": "2025-01-08",
"gongdan-jeong-eub-dc": "2025-01-22",
"duwon-dc": "2025-01-15",
"seokjeon-dc": "2025-01-08",
"daejeoncheongsa-aram-dc": "2025-01-08",
"agidungji-dc": "2025-01-08",
"parangsae-dc": "2025-01-09",
"saetbyeol-dc": "2025-01-09",
"cheongmyeong-dc": "2025-01-16",
"saebom-dc": "2025-01-15",
"yumyumplay-dc": "2025-01-15",
"yeneung-easternkids-dc": "2025-01-16",
"chowol-cheongmyeong-dc": "2025-01-15",
"bukguchung-dc": "2025-01-25",
"haengboksoop-dc": "2025-02-05",
"sezanne-dc": "2025-02-12",
"chorok-dc": "2025-02-19",
"bukbu-dc": "2025-02-05",
"gwangmyeong-gurumsan-dc": "2025-02-07",
"prugioai-dc": "2025-02-05",
"woorichunsa-dc": "2025-02-21",
"ireader-dc": "2025-02-21",
"guribgayang-dc": "2025-02-19",
"gurip-saehaneul-dc": "2025-02-19",
"yumyumplay-dc": "2025-02-19",
"kidsi1-dc": "2025-02-27",
"gangbyun-dc": "2025-02-05",
"ja-yeon-yua-dc": "2025-02-20",
"sirip-sujain-dc": "2025-02-05",
"gamman-dc": "2025-02-05",
"jincheon-kkumnarae-dc": "2025-02-05",
"ifun-dc": "2025-02-19",
"cheongwongu-office-dc": "2025-02-26",
"jangyu-dc": "2025-02-05",
"hanbyeol-dc": "2025-02-21",
"pungmu-dc": "2025-02-04",
"magok6-forest-dc": "2025-02-19",
"eundo-dc": "2025-02-19",
"sirip-gochoncentralzai-dc": "2025-02-05",
"thelakecity2danjibooyounglove-dc": "2025-02-21",
"gwandong-dc": "2025-02-05",
"angel-dc": "2025-02-05",
"malg-eunsaem-dc": "2025-02-07",
"duchon-dc": "2025-02-19",
"yeonkkoch-dc": "2025-02-05",
"gongdan-namdong-dc": "2025-02-05",
"unam-dc": "2025-02-12",
"he-mang-dc": "2025-02-05",
"haes-sal-dc": "2025-02-05",
"kwangdo-dc": "2025-02-21",
"ehwa-dc": "2025-02-21",
"hanwool-dc": "2025-02-19",
"gbdooffice-dc": "2025-02-26",
"sinwon-dc": "2025-02-19",
"hyeyum-dc": "2025-02-21",
"yuhwa-k": "2025-02-11",
"haedalbyeol-k": "2025-02-19",
"gippeum-dc": "2025-02-05",
"sireip-thefirst-dc": "2025-02-05",
"cheongmyeong-dc": "2025-02-12",
"neulpureunnamu-dc": "2025-02-26",
"sirip-masong-dc": "2025-02-05",
"eobang-dc": "2025-02-05",
"kkumjaram-dc": "2025-02-05",
"hangdonghalang-dc": "2025-02-05",
"onemajor-xi-dc": "2025-02-05",
"daejeon-geomchal-dc": "2025-02-04",
"chowol-cheongmyeong-dc": "2025-02-12",
"gongdan-jeong-eub-dc": "2024-12-04",
"sunjae-dc": "2024-12-18",
"myeongryun-dc": "2024-12-18",
"eokkaedongmu-dc": "2024-12-18",
"donghwasok-dc": "2024-12-18",
"gugi-dc": "2024-12-18",
"yeonkkoch-dc": "2024-12-18",
"oryukdo-dc": "2024-12-27",
"parannara-dc": "2024-12-13",
"gumin-dc": "2024-12-18",
"yeokgokhana-dc": "2024-12-18",
"gaon-dc": "2024-12-11",
"aiville-dc": "2024-12-18",
"gongdan-gwangju-dc": "2024-12-12",
"kkotnaeum-dc": "2024-12-04",
"nonsan-woori-dc": "2024-12-11",
"chodong-dc": "2024-12-18",
"aitteul-dc": "2024-12-20",
"isori-dc": "2024-12-18",
"sejongmaeul-dc": "2024-12-18",
"buam-dc": "2024-12-18",
"saewoomteo-dc": "2024-12-18",
"sangroksu-dc": "2024-12-18",
"yeondong-dc": "2024-12-18",
"haedameun-dc": "2024-12-04",
"gahoe-dc": "2024-12-18",
"gamman-dc": "2024-12-27",
"gurip-guil-dc": "2024-12-18",
"dodamdodam-dc": "2024-12-18",
"he-mang-dc": "2024-12-18",
"castleandcantaville-dc": "2024-12-05",
"yeonmu-dc": "2024-12-11",
"gongdan-busan-dc": "2024-12-04",
"soongin-dc": "2024-12-18",
"purunsoop-dc": "2024-12-18",
"changsin-dc": "2024-12-18",
"hangdonghalang-dc": "2024-12-18",
"yuhwa-k": "2024-12-18",
"sungsim-dc": "2024-12-02",
"adonghwekwan-dc": "2024-12-18",
"yangwoo-dasom-dc": "2024-12-04",
"yangwoo-dasom-dc": "2024-12-26",
"hyehwa-dc": "2024-12-18",
"malg-eunsaem-dc": "2024-12-18",
"yedaumyeong-a-dc": "2024-12-04",
"ontteulepium-dc": "2024-12-04",
"jayeonedu-dc": "2024-12-04",
"unam-k": "2024-12-04",
"muak-dc": "2024-12-18",
"haes-sal-dc": "2024-12-18",
"daecheong-dc": "2024-12-05",
"gongdan-gyelyong-dc": "2024-12-05",
"yongdang-dc": "2024-12-27",
"kyungsung-dc": "2024-12-27",
"chungwoon-dc": "2024-12-18",
"agidungji-dc": "2024-12-11",
"sazik-dc": "2024-12-18",
"gongdan-gomdallae-dc": "2024-12-10",
"myeongin-dc": "2024-12-11",
"jeil-dc": "2024-12-11",
"gongju-haes-sal-dc": "2024-12-18",
"saengmyeongsup-dc": "2024-12-18",
"yeonmu-haengbok-dc": "2024-12-18",
"kidsi1-dc": "2024-12-20",
"segkyo-piaje-dc": "2025-01-23",
"ireader-dc": "2025-01-02",
"kidsi1-dc": "2025-01-16",
"jaeundae-dc": "2025-01-10",
"gongdan-ulsan-dc": "2025-01-07",
"hanbyeol-dc": "2025-01-03",
"gongdan-siheung-dc": "2025-01-07",
"sirip-sujain-dc": "2025-01-22",
"gukbangdaehakyo-dc": "2025-01-03",
"kidspark-dc": "2025-01-03",
"gongdan-gyelyong-dc": "2025-01-16",
"thelakecity2danjibooyounglove-dc": "2025-01-03",
"woorichunsa-dc": "2025-01-03",
"kwangdo-dc": "2025-01-03",
"sireip-thefirst-dc": "2025-01-22",
"saessaknara-k": "2025-01-22",
"daeyeon-dc": "2025-01-22",
"wirye-sol-dc": "2025-01-15",
"gippeum-dc": "2025-01-22",
"aram-dc": "2025-01-23",
"sirip-masong-dc": "2025-01-22",
"gangbyun-dc": "2025-01-15",
"maesuri9danji-dc": "2025-01-22",
"gongdan-hwaseong-dc": "2025-02-26",
"eokkaedongmu-dc": "2025-02-19",
"gongdan-gyelyong-dc": "2025-02-20",
"kidsi1-dc": "2025-02-20",
"chamjoeun-dc": "2025-02-12",
"gamman-dc": "2025-02-21",
"ilgwang-zaiprugeo2-dc": "2025-02-12",
"hansung-dc": "2025-02-12",
"duchon-dc": "2025-02-05",
"saengmyeongsup-dc": "2025-02-19",
"gongdan-busan-dc": "2025-02-19",
"algok-dc": "2025-02-19",
"cheongmyeong-dc": "2025-02-19",
"ilgwang-dc": "2025-02-12",
"jangan-dc": "2025-02-12",
"kkotnaeum-dc": "2025-02-05",
"chowol-cheongmyeong-dc": "2025-02-19",
}

from_uris = []
to_uris = []

save_root = "/mnt/nas/data/kaeun/2025q1/kids/dupbab/dupbab_test_images"
for dep_name, date in dep_date.items():
    date = date.replace("2025-", "25").replace("-", "")
    date = date.replace("2024-", "24").replace("-", "")
    prefix = f"{dep_name}/{date}/L/B"
    imgs = s3_api.list_objects('nuvi-data', prefixes=prefix, endswith='.png')
    if imgs:
        for img in imgs:
            from_uri = s3_api.make_uri('nuvi-data', img)
            to_uri = os.path.join(save_root, img.split('/')[-1])
            from_uris.append(from_uri)
            to_uris.append(to_uri)

s3_api.cp(from_uris, to_uris)
print(len(from_uris))
print(len(to_uris))
